# USE i3-msg [reload|restart] AFTER MODIFYING THIS FILE TO AVOID RESTARTING X
# (see reload and restart bindings)

##### GENERAL SETTINGS
# use mod1 as the modifier
# run xmodmap to see what mod1 is
set $mod Mod1

# set some variables e.g. 'set $WS1 1:terminal'
# TODO: use ttf-font-awesome
set $WS1  1:comms
set $WS2  2:tmp2
set $WS3  3:tmp3
set $WS4  4:tmp4
set $WS5  5:tmp5

set $SCREEN_SAVER_IMG ~/Downloads/07895117-photo-windowsxp.png
set $SCREENSHOTS_FOLDER ~/Documents/Pictures/Screenshots/
set $TOUCHPAD "DLL075B:01 06CB:76AF Touchpad"

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:Monaco 6
#try also Inconsolata or DejaVu

#### i3 SESSION CONTROL
# RELOAD the configuration file
bindsym $mod+Shift+c reload
# RESTART i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# EXIT i3 (logs you out of your X session)
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

##### CONTAINERS, WINDOW CONTROLS AND NAVIGATION
# No border
new_window none
hide_edge_borders smart

# kill focused window
bindsym $mod+Shift+q kill

# focus parent
bindsym $mod+u focus parent

# change focus
bindsym $mod+j focus left
bindsym $mod+k focus down
bindsym $mod+l focus up
bindsym $mod+semicolon focus right

# move focused window
bindsym $mod+Shift+j move left
bindsym $mod+Shift+k move down
bindsym $mod+Shift+l move up
bindsym $mod+Shift+semicolon move right

# split horizontal/vertical
# (default are the opposite but my brains refuses to work that way)
bindsym $mod+h split v
bindsym $mod+v split h

# enter fullscreen mode for the focused container
bindsym $mod+Shift+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Toggle between stacking/tabbed/splith/splitv
bindsym $mod+x layout toggle all

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

##### WORKSPACES
# switch to workspace
bindsym $mod+1 workspace $WS1
bindsym $mod+2 workspace $WS2
bindsym $mod+3 workspace $WS3
bindsym $mod+4 workspace $WS4

# switch to next/previous workspace
bindsym $mod+Tab workspace next
bindsym $mod+Shift+Tab workspace prev

# Automatic back-and-forth between windows
workspace_auto_back_and_forth yes
bindsym $mod+z workspace back_and_forth

# move between workspaces by name
bindsym $mod+i exec i3-msg workspace $(i3-msg -t get_workspaces | jq -r ".[].name" | dmenu)

# move container to workspace by name
bindsym $mod+Shift+i  exec i3-msg move container to workspace $(i3-msg -t get_workspaces | jq -r ".[].name" | dmenu)

# rename workspace
bindsym $mod+n exec i3-input -F 'rename workspace to "%s"' -P 'New name: '

##### SCRATCHPAD
# make the currently focused window a scratchpad
bindsym $mod+Shift+minus move scratchpad

# toggle show/hide of the first scratchpad window
bindsym $mod+minus scratchpad show

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3
bindsym $mod+Shift+4 move container to workspace $WS4

# Put this window on the HDMI output (external screen)
bindsym $mod+y move container to output HDMI1

# Put this window on the main output (laptop screen)
bindsym $mod+Shift+y move container to output eDP1

# SPECIAL MODES
# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym j resize shrink width 5 px or 5 ppt
        bindsym k resize grow height 5 px or 5 ppt
        bindsym l resize shrink height 5 px or 5 ppt
        bindsym semicolon resize grow width 5 px or 5 ppt
        bindsym Shift+j resize shrink width 10 px or 10 ppt
        bindsym Shift+k resize grow height 10 px or 10 ppt
        bindsym Shift+l resize shrink height 10 px or 10 ppt
        bindsym colon resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}
# enter window resize mode
bindsym $mod+r mode "resize"

# Power management commands
# TODO: find a bindsym for that
set $locker i3lock -ec 000000
set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (p) poweroff
mode "$mode_system" {
	bindsym l exec --no-startup-id $locker, mode "default"
	bindsym e exec --no-startup-id i3-msg exit, mode "default"
	bindsym s exec --no-startup-id $locker && systemctl suspend, mode "default"
	bindsym h exec --no-startup-id $locker && systemctl hibernate, mode "default"
	bindsym r exec --no-startup-id systemctl reboot, mode "default"
	bindsym p exec --no-startup-id systemctl poweroff, mode "default"

	# back to normal: Enter or Escape
	bindsym Return mode "default"
	bindsym Escape mode "default"
}
# enter power management mode
bindsym $mod+p mode "$mode_system"

## Manual management of external displays
# TODO: fix this one, it would be useful
#set $mode_display Screen (1) VGA ON, (2) HDMI ON, (3) VGA OFF, (4) HDMI OFF
#mode "$mode_display" {
#	bindsym 1 exec --no-startup-id xrandr --output VGA-1 --auto --same-as eDP-1, mode "default"
#	bindsym 2 exec --no-startup-id xrandr --output HDMI-1 --auto --same-as eDP-1, mode "default"
#	bindsym 3 exec --no-startup-id xrandr --output VGA-1 --auto --off, mode "default"
#	bindsym 4 exec --no-startup-id xrandr --output HDMI-1 --auto --off, mode "default"
#
#	# back to normal: Enter or Escape
#	bindsym Return mode "default"
#	bindsym Escape mode "default"
#}
# enter display management mode
#bindsym $mod+F2 mode "$mode_display"

# WINDOW ASSIGNMENTS AND STARTUP APPS
# start the browser
exec vivaldi-stable

# start a scratchpad terminal
# TODO: add border for this one
exec --no-startup-id urxvt -name scratch
for_window [class="^URxvt$" instance="^scratch$"] move scratchpad

##### APP BINDINGS
# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# start the program launcher
bindsym $mod+d exec dmenu_run

# take a screenshot and put it in clipboard
bindsym $mod+g exec --no-startup-id maim -i $(xdotool getactivewindow) | xclip -selection clipboard -t image/png
# take a selection screenshot and save to special folder
bindsym $mod+Shift+g exec --no-startup-id maim -usk $SCREENSHOTS_FOLDER/$(date +%s).png

# lock the screen with a background
#bindsym --release $mod+Shift+s exec i3lock -u -i $SCREEN_SAVER_IMG -p win -e
# lock the screen using slock
bindsym --release $mod+Shift+s exec sleep 0.5 && xset dpms force off && slock

# open youtube videos in the same workspace as mps-youtube
# (fix it: not really working)
for_window [class="^mpv$" instance="^gl$"] floating enable
# open pass & Co. dialog boxes in floating window
for_window [class="Pinentry"] floating enable
# open images in floating window
for_window [class="^feh$"] floating enable
# open zoom in floting window
#for_window [class="^zoom$"] floating enable resize set 1024 768
floating_maximum_size 1024 x 768

# TODO: limit popup window dimensions
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable
for_window [window_type="About"] floating enable
#for_window [window_type="Settings"] floating enable

# Touchpad controls
# TODO: fix this on Latitude
#bindsym $mod+t       exec --no-startup-id xinput --disable "$TOUCHPAD"
#bindsym $mod+Shift+t exec --no-startup-id xinput --enable "$TOUCHPAD"

#### I3BAR SETTINGS
# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
        status_command          i3status --config ~/.config/i3/status.conf
	mode                    dock
	position		bottom
	#output                  primary
	tray_output             none
	font                    pango:Monaco 8
	separator_symbol        "•"
	workspace_buttons	yes
	strip_workspace_numbers yes
	binding_mode_indicator	yes
	colors {
				# whole color settings
		background	"#000000"
		statusline	"#ffffff"
		separator	"#0093b0"

		# Type			border		background	text
		focused_workspace	"#008fff"	"#0093b0"	"#ffffff"
		active_workspace	"#444444"	"#5f676a"	"#ffffff"
		inactive_workspace	"#444444"	"#222222"	"#888888"
		urgent_workspace	"#aa0000"	"#990000"	"#ffffff"
	}
}


##### EXTRA KEYS BINDINGS
# volume
#bindsym XF86AudioRaiseVolume exec amixer set Master 5+     # increase sound volume
#bindsym XF86AudioLowerVolume exec amixer set Master 5-     # decrease sound volume
#bindsym XF86AudioMute        exec amixer set Master toggle # mute sound
#bindsym XF86AudioMicMute exec amixer set Capture toggle # mute mic

# screen brightness controls
#bindsym XF86MonBrightnessUp   exec xbacklight -inc 5 # increase screen brightness
#bindsym XF86MonBrightnessDown exec xbacklight -dec 5 # decrease screen brightness

# audio-controls bindings
# (need mpris compatible client, mpsyt is not, don't want to install pulse)
#bindsym XF86AudioPlay exec "playerctl play-pause"
#bindsym XF86AudioNext exec "playerctl next"
#bindsym XF86AudioPrev exec "playerctl previous"
